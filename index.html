<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CERDAS - Capaian Edukasi dan Realisasi Dashboard BPMP Provinsi Maluku</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .program-card {
            transition: all 0.3s ease;
            position: relative;
        }
        .program-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .admin-controls {
            position: absolute;
            top: 8px;
            right: 8px;
            opacity: 0;
            transition: all 0.3s ease;
            display: none;
            z-index: 10;
        }
        .admin-mode .program-card:hover .admin-controls {
            opacity: 1;
            display: flex;
            gap: 4px;
        }
        .admin-mode .admin-controls {
            display: flex;
            gap: 4px;
        }
        .admin-mode .program-card {
            position: relative;
        }
        .admin-panel {
            display: none;
        }
        .admin-mode .admin-panel {
            display: block;
        }
        .delete-btn {
            transition: all 0.2s ease;
        }
        .delete-btn:hover {
            transform: scale(1.1);
            background-color: rgba(239, 68, 68, 0.8) !important;
        }
        .status-btn {
            transition: all 0.2s ease;
        }
        .status-btn:hover {
            transform: scale(1.1);
        }
        .program-inactive {
            opacity: 0.6;
            filter: grayscale(0.3);
        }
        .drag-mode .program-card {
            cursor: grab;
        }
        .drag-mode .program-card:active {
            cursor: grabbing;
        }
        .drag-mode .program-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        .drag-placeholder {
            border: 2px dashed #cbd5e0;
            background-color: #f7fafc;
            border-radius: 0.75rem;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #a0aec0;
            font-weight: 500;
        }
        .icon-option.selected {
            background-color: #3b82f6 !important;
            color: white;
        }
        .icon-option.selected .text-gray-600 {
            color: white !important;
        }
        .icon-option.selected svg {
            color: white !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-600">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button id="dragToggleBtn" onclick="toggleDragMode()" class="admin-panel w-12 h-12 bg-gray-600 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors" title="Toggle Drag & Drop">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path>
                        </svg>
                    </button>
                    <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800"><span class="text-red-600">CERDAS</span> - <span class="text-red-600">C</span>apaian <span class="text-red-600">E</span>dukasi dan <span class="text-red-600">R</span>ealisasi <span class="text-red-600">Das</span>hboard</h1>
                        <p class="text-gray-600">BPMP Provinsi Maluku</p>
                    </div>
                </div>
                <div class="text-right flex items-center space-x-4">
                    <div>
                        <p class="text-sm text-gray-500">Tahun 2024</p>
                        <p class="text-lg font-semibold text-blue-600"><span id="programCount">10</span> Program Aktif</p>
                    </div>
                    <div class="admin-panel relative">
                        <button id="backupBtn" onclick="toggleBackupMenu()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                            </svg>
                            Backup
                            <svg class="w-4 h-4 ml-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        
                        <!-- Backup Dropdown Menu -->
                        <div id="backupMenu" class="absolute right-0 top-full mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-50 hidden">
                            <div class="py-2">
                                <div class="px-4 py-2 text-sm text-gray-500 border-b border-gray-100">
                                    <strong>Pilih Jenis Backup</strong>
                                </div>
                                <button onclick="downloadBackup(); closeBackupMenu();" class="w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 flex items-center">
                                    <svg class="w-4 h-4 mr-3 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15.586 13H14a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                                    </svg>
                                    <div>
                                        <div class="font-medium">Backup Data (JSON)</div>
                                        <div class="text-xs text-gray-500">Simpan data program & pengaturan</div>
                                    </div>
                                </button>
                                <button onclick="downloadHTMLBackup(); closeBackupMenu();" class="w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 flex items-center">
                                    <svg class="w-4 h-4 mr-3 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                    <div>
                                        <div class="font-medium">Backup HTML</div>
                                        <div class="text-xs text-gray-500">Unduh file HTML lengkap</div>
                                    </div>
                                </button>
                                <div class="border-t border-gray-100 mt-2 pt-2">
                                    <div class="px-4 py-2 text-xs text-gray-400">
                                        ðŸ’¡ Backup otomatis tersimpan dengan timestamp
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button id="loginToggle" onclick="showLoginModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 3a1 1 0 011 1v12a1 1 0 11-2 0V4a1 1 0 011-1zm7.707 3.293a1 1 0 010 1.414L9.414 9H17a1 1 0 110 2H9.414l1.293 1.293a1 1 0 01-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        Login
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        <!-- Admin Panel -->
        <div class="admin-panel mb-8 bg-white rounded-xl p-6 shadow-lg border-l-4 border-red-500">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">Panel Admin</h2>
                <button onclick="openAddProgramModal()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                    </svg>
                    Tambah Program
                </button>
            </div>
            <p class="text-gray-600">Mode admin aktif. Anda dapat mengedit, menghapus, atau menambah program baru. Hover pada kotak program untuk melihat kontrol admin.</p>
        </div>

        <!-- Program Grid -->
        <div id="programGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Programs will be loaded here by JavaScript -->
        </div>

        <!-- Statistics Section -->
        <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white rounded-xl p-6 shadow-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">Total Program</p>
                        <p id="totalProgramCount" class="text-3xl font-bold text-gray-800">10</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl p-6 shadow-lg">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">Program Aktif</p>
                        <p id="activeProgramCount" class="text-3xl font-bold text-green-600">10</p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                </div>
            </div>
            

        </div>
    </main>

    <!-- Program Detail Page -->
    <div id="programDetailPage" class="fixed inset-0 bg-white hidden z-40 overflow-y-auto">
        <div class="min-h-screen">
            <!-- Header Detail Page -->
            <header class="bg-white shadow-lg border-b-4 border-blue-600 sticky top-0 z-10">
                <div class="max-w-7xl mx-auto px-6 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <button onclick="closeProgramDetail()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                            </button>
                            <div>
                                <h1 id="detailProgramTitle" class="text-xl font-bold text-gray-800">Nama Program</h1>
                                <p class="text-gray-600">Detail Program</p>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button id="editDetailBtn" onclick="toggleEditMode()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                                </svg>
                                Edit
                            </button>
                            <button id="saveDetailBtn" onclick="saveDetailChanges()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors hidden">
                                <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                                Simpan
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Detail Page -->
            <main class="max-w-7xl mx-auto px-6 py-8">
                <!-- Tujuan Section -->
                <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Tujuan</h2>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                    <div id="pengantarView" class="text-gray-600 leading-relaxed">
                        <p class="text-gray-400 italic">Belum ada tujuan. Klik tombol Edit untuk menambahkan.</p>
                    </div>
                    <textarea id="pengantarEdit" class="w-full h-32 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 hidden" placeholder="Masukkan tujuan program..."></textarea>
                </div>

                <!-- Objective Section -->
                <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Objective</h2>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                    <div id="objectiveView" class="text-gray-600 leading-relaxed">
                        <p class="text-gray-400 italic">Belum ada objective. Klik tombol Edit untuk menambahkan.</p>
                    </div>
                    <textarea id="objectiveEdit" class="w-full h-32 p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 hidden" placeholder="Masukkan objective program..."></textarea>
                </div>

                <!-- Materi Section -->
                <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Materi</h2>
                        <div class="flex items-center space-x-3">
                            <button id="addMateriBtn" onclick="addNewMateri()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors text-sm hidden">
                                <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                                </svg>
                                Tambah Materi
                            </button>
                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V4.804z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Materi List View -->
                    <div id="materiListView" class="space-y-4">
                        <p class="text-gray-400 italic">Belum ada materi. Klik tombol Edit untuk menambahkan.</p>
                    </div>
                    
                    <!-- Materi Edit Form -->
                    <div id="materiEditForm" class="hidden space-y-6">
                        <div id="materiItemsContainer" class="space-y-6">
                            <!-- Materi items will be added here dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Dashboard Section -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Dashboard</h2>
                        <div class="flex items-center space-x-3">
                            <button id="addDashboardBtn" onclick="addNewDashboard()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors text-sm hidden">
                                <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                                </svg>
                                Tambah Dashboard
                            </button>
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dashboard List View -->
                    <div id="dashboardListView" class="space-y-4">
                        <p class="text-gray-400 italic">Belum ada dashboard. Klik tombol Edit untuk menambahkan.</p>
                    </div>
                    
                    <!-- Dashboard Edit Form -->
                    <div id="dashboardEditForm" class="hidden space-y-6">
                        <div id="dashboardItemsContainer" class="space-y-6">
                            <!-- Dashboard items will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md mx-4 transform transition-all">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">Login Admin</h3>
                <button onclick="closeLoginModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="username" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div id="loginError" class="text-red-600 text-sm hidden">Username atau password salah!</div>
                <div class="flex space-x-3 pt-4">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                        Login
                    </button>
                    <button type="button" onclick="closeLoginModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                        Batal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Program Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-lg mx-4 transform transition-all">
            <div class="flex items-center justify-between mb-6">
                <h3 id="editModalTitle" class="text-xl font-bold text-gray-800">Tambah Program Baru</h3>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form id="programForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Program</label>
                    <input type="text" id="programName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="programDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Warna</label>
                    <select id="programColor" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="red">Merah</option>
                        <option value="blue">Biru</option>
                        <option value="green">Hijau</option>
                        <option value="purple">Ungu</option>
                        <option value="orange">Oranye</option>
                        <option value="teal">Teal</option>
                        <option value="pink">Pink</option>
                        <option value="indigo">Indigo</option>
                        <option value="yellow">Kuning</option>
                        <option value="gray">Abu-abu</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Icon Program</label>
                    <div class="grid grid-cols-6 gap-3 p-4 border border-gray-300 rounded-lg bg-gray-50 max-h-48 overflow-y-auto">
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="school" onclick="selectIcon('school')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Sekolah</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="computer" onclick="selectIcon('computer')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Komputer</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="users" onclick="selectIcon('users')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM9 8a2 2 0 100-4 2 2 0 000 4zM7 14a5.981 5.981 0 00-3.505 1.126C2.686 15.89 2 16.681 2 17.5V18a1 1 0 001 1h12a1 1 0 001-1v-.5c0-.819-.686-1.61-1.495-2.374A5.981 5.981 0 0011 14H7z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Pengguna</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="clipboard" onclick="selectIcon('clipboard')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"></path>
                                    <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Clipboard</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="book" onclick="selectIcon('book')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V4.804z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Buku</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="heart" onclick="selectIcon('heart')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Hati</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="food" onclick="selectIcon('food')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Makanan</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="chart" onclick="selectIcon('chart')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Grafik</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="shield" onclick="selectIcon('shield')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Perisai</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="money" onclick="selectIcon('money')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zM14 6a2 2 0 012 2v4a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h8zM6 8a2 2 0 012 2v2a2 2 0 01-2 2V8zM8 8a2 2 0 012 2v2a2 2 0 01-2 2V8z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Uang</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="star" onclick="selectIcon('star')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Bintang</span>
                        </div>
                        <div class="icon-option flex flex-col items-center p-2 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" data-icon="cog" onclick="selectIcon('cog')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="text-xs text-gray-600">Pengaturan</span>
                        </div>
                    </div>
                    <input type="hidden" id="programIcon" value="school">
                    <p class="text-sm text-gray-500 mt-2">Pilih icon yang sesuai dengan program Anda</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Link/URL (opsional)</label>
                    <input type="url" id="programLink" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com">
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                        Simpan
                    </button>
                    <button type="button" onclick="closeEditModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                        Batal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Data program yang tersimpan
        let programs = [
            { id: 1, name: 'Revitalisasi Sekolah', description: 'Program pembaruan dan peningkatan fasilitas sekolah', color: 'red', icon: 'school', link: '', pengantar: 'Meningkatkan akses layanan pendidikan dan kualitas pembelajaran di satuan pendidikan untuk mewujudkan layanan pendidikan bermutu untuk semua melalui penyediaan sarana dan prasarana esensial bagi pendidikan yang berkualitas, aman, dan nyaman', objective: '', materi: [], dashboards: [], active: true },
            { id: 2, name: 'Digitalisasi Pembelajaran', description: 'Transformasi digital dalam sistem pembelajaran modern', color: 'blue', icon: 'computer', link: '', pengantar: 'Memenuhi kebutuhan sarana pembelajaran dan meningkatkan kualitas pembelajaran berbasis digital yang merata di seluruh Indonesia', objective: '1. Penyediaan Bantuan Sarana Digitalisasi Pembelajaran tersalurkan di xxx satuan pendidikan dan sesuai dengan spesifikasi di seluruh Indonesia\n2. Pendampingan Multimoda Pengelolaan Bantuan Sarana Digitalisasi Pembelajaran di xx% Satuan Pendidikan', materi: [], dashboards: [], active: true },
            { id: 3, name: 'Sistem Penerimaan Murid Baru', description: 'Sistem digital untuk penerimaan siswa baru', color: 'green', icon: 'users', link: '', pengantar: 'Mendukung terwujudnya peningkatan akses pendidikan, menjamin keadilan dan pemerataan kualitas pendidikan  bagi semua anak, termasuk kelompok rentan dan tidak mampu melalui SPMB secara objektif, transparan, akuntabel, berkeadilan, dan tanpa diskriminasi', objective: '1. 100% Pemda sudah menetapkan juknis SPMB\n2. Pemda Provinsi dan 20%  Pemda Kab/Kota melibatkan sekolah swasta dalam SPMB\n3. Pemda Provinsi dan 40% Pemda kab/kota melaksanakan penandatanganan pakta integritas/ komitmen bersama/deklarasi SPMB bersih', materi: [], dashboards: [], active: true },
            { id: 4, name: 'Wajib Belajar 13 Tahun', description: 'Program wajib belajar hingga jenjang SMA/SMK', color: 'purple', icon: 'book', link: '', pengantar: 'Terwujudnya perluasan dan pemerataan akses Pendidikan anak usia dini, dasar, danmenengah yang bermutu, guna menciptakan sumber daya manusia yang berkualitas, berdaya saing, dan siap menghadapi tantangan abad ke-21', objective: '1.a.Meningkatkan Angka Partisipasi 5-6 tahun  sebesar 77,3%\n  b.Meningkatkan Angka Partisipasi 7-12 tahun diatas 99% sebesar 77,24%\n  c. Meningkatkan Angka Partisipasi 13-15 tahun diatas 95% sebesar 77,63%\n  d. Meningkatkan Angka Partisipasi Kasar 16-18 di atas 95% sebesar 26,32%\n2 a. Penanganan ATS di jenjang SD sebesar 5.837 orang\n  b. Penanganan ATS  di jenjang SMP sebesar 4.947 orang\n  c. Penanganan ATS di jenjang SMA sebesar 2.364 orang', materi: [], dashboards: [], active: true },
            { id: 5, name: 'Penguatan Pendidikan Karakter', description: 'Pembentukan karakter dan nilai-nilai moral siswa', color: 'orange', icon: 'heart', link: '', pengantar: 'Meningkatkan dan mengembangkan potensi, kesehatan, kecerdasan, karakter, kepemimpinan, serta bakat dan minat peserta didik melalui pembiasaan positif dan pengelolaan kegiatan ekstrakurikuler yang baik', objective: '1. 100% satuan pendidikan menerapkan Gerakan 7 Kebiasaan Anak Indonesia Hebat\n2. 20% Satuan pendidikan mendapatkan advokasi pelaksanaan G7KAIH', materi: [], dashboards: [], active: true },
            { id: 6, name: 'Makanan Bergizi Gratis', description: 'Program pemberian makanan bergizi untuk siswa', color: 'teal', icon: 'food', link: '', pengantar: 'Mengatasi masalah stunting dan malnutrisi pada anak-anak Indonesia dengan menyediakan makanan bergizi gratis, untuk dapat meningkatkan daya saing generasi muda Indonesia di tingkat global melalui perbaikan gizi dan kesehatan', objective: '1. Kemendikdasmen dan BGN memiliki nota kesepahaman sebagai landasan kolaborasi implementasi program MBG di satuan pendidikan;\n2. 10.000 satuan pendidikan penerima manfaat MBG teridentifikasi data kesiapan dan persiapannya menerima program MBG\n3. â€¦. Pemda yang telah mendapatkan manfaat program MBG mendapatkan pendampingan\n4. 14 dari 19 data indikator evaluasi program MBG di satuan pendidikan teridentifikasi.', materi: [], dashboards: [], active: true },
            { id: 7, name: 'Pembelajaran dan Penilaian', description: 'Sistem pembelajaran dan evaluasi yang efektif', color: 'pink', icon: 'clipboard', link: '', pengantar: 'Pembelajaran Mendalam merupakan pendekatan yang memuliakan dengan menekankan pada penciptaan suasana belajar dan proses pembelajaran berkesadaran, bermakna, dan menggembirakan melalui olah pikir, olah hati, olah rasa, dan olah raga secara holistik dan Terpadu.\nPenilaian dilakukan untuk mengukur tingkat pencapaian kompetensi peserta didik dan memberikan umpan balik bagi perbaikan proses belajar-mengajar.', objective: '1. 100% Satuan Pendidikan Penerima Boskin menerapkan Pembelajaran Mendalam\n2. 100% Satuan Pendidikan Penerima Boskin Menerapkan Pembelajaran Koding dan Kecerdasan Artifisial\n3. a) 50% Dinas Pendidikan Prov./Kab./Kota Mendukung Upaya Peningkatan Kualitas Pembelajaran (Pembelajaran Mendalam, Koding & KA, Peningkatan Literasi Numerasi dan Sains, Perubahan iklim).\n    b) 100% Dinas Pendidikan Prov./Kab./Kota Mendukung Upaya Peningkatan Kualitas Penilaian (seperti Digitalisasi Ijazah, TKA, ANBK, atau E Rapor)', materi: [], dashboards: [], active: true },
            { id: 8, name: 'Penjaminan Mutu Pendidikan', description: 'Sistem penjaminan kualitas pendidikan', color: 'indigo', icon: 'shield', link: '', pengantar: 'Mewujudkan pendidikan yang berkeadilan, berkualitas dan berdaya saing. Layanan pendidikan memenuhi standar nasional pendidikan secara konsisten, guna meningkatkan kualitas proses dan hasil pembelajaran serta menjamin pemerataan mutu Pendidikan di seluruh satuan pendidikan.', objective: '1. 100% satuan pendidikan dapat dipetakan sesuai 8 SNP\n2a. 37% satuan Pendidikan (Dasmen) memiliki capaian mutu sesuai SNP\n b. 65% satuan pendidikan (Dasmen) menerapkan PMP\n3a. 17% pemda memiliki capaian mutu sesuai SPM (minimal Tuntas Madya)\n b. 81% pemda mengalokasikan sumber daya sesuai capaian Rapor Pendidik', materi: [], dashboards: [], active: true },
            { id: 9, name: 'BOSP', description: 'Bantuan Operasional Satuan Pendidikan', color: 'yellow', icon: 'money', link: '', pengantar: 'Meningkatkan Akses dan Kualitas Pendidikan: Memastikan pendidikan yang berkualitas dapat diakses oleh seluruh warga negara.\nMeringankan Beban Biaya Pendidikan: Membantu beban biaya operasional sekolah bagi siswa, terutama siswa dari keluarga miskin atau tidak mampu.\nMendukung Wajib Belajar: Memastikan pelaksanaan program wajib belajar yang berkualitas dan berkelanjutan.', objective: '1. Meningkatkan akses dan kualitas pendidikan dengan memastikan pendidikan yang berkualitas dapat diakses oleh seluruh warga negara\n2. Meringankan beban biaya pendidikan dengan membantu beban biaya operasional sekolah bagi siswa, terutama siswa dari keluarga miskin atau tidak mampu\n3. Mendukung program wajib belajar dengan memastikan pelaksanaan program wajib belajar yang berkualitas dan berkelanjutan', materi: [], dashboards: [], active: true }
        ];

        let isAdminMode = false;
        let editingProgramId = null;
        let currentProgramId = null;
        let isEditingDetail = false;
        let isDragMode = false;
        let draggedElement = null;
        let draggedIndex = null;

        // Kredensial admin
        const adminCredentials = {
            username: 'rayhan',
            password: '4dm1n_d@sh'
        };

        // Function to select icon
        function selectIcon(iconName) {
            // Remove selected class from all icons
            document.querySelectorAll('.icon-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked icon
            const selectedOption = document.querySelector(`[data-icon="${iconName}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
            
            // Set the hidden input value
            document.getElementById('programIcon').value = iconName;
        }

        // Warna yang tersedia
        const colorClasses = {
            red: 'from-red-500 to-red-600',
            blue: 'from-blue-500 to-blue-600',
            green: 'from-green-500 to-green-600',
            purple: 'from-purple-500 to-purple-600',
            orange: 'from-orange-500 to-orange-600',
            teal: 'from-teal-500 to-teal-600',
            pink: 'from-pink-500 to-pink-600',
            indigo: 'from-indigo-500 to-indigo-600',
            yellow: 'from-yellow-500 to-yellow-600',
            gray: 'from-gray-600 to-gray-700'
        };

        // Icon SVG untuk setiap program
        const programIcons = {
            school: '<path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"></path>',
            computer: '<path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd"></path>',
            users: '<path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM9 8a2 2 0 100-4 2 2 0 000 4zM7 14a5.981 5.981 0 00-3.505 1.126C2.686 15.89 2 16.681 2 17.5V18a1 1 0 001 1h12a1 1 0 001-1v-.5c0-.819-.686-1.61-1.495-2.374A5.981 5.981 0 0011 14H7z"></path>',
            clipboard: '<path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"></path><path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"></path>',
            book: '<path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V4.804z"></path>',
            heart: '<path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>',
            food: '<path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>',
            chart: '<path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>',
            shield: '<path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>',
            money: '<path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zM14 6a2 2 0 012 2v4a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h8zM6 8a2 2 0 012 2v2a2 2 0 01-2 2V8zM8 8a2 2 0 012 2v2a2 2 0 01-2 2V8z"></path>',
            star: '<path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>',
            cog: '<path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>',
            default: '<path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM9 8a2 2 0 100-4 2 2 0 000 4zM7 14a5.981 5.981 0 00-3.505 1.126C2.686 15.89 2 16.681 2 17.5V18a1 1 0 001 1h12a1 1 0 001-1v-.5c0-.819-.686-1.61-1.495-2.374A5.981 5.981 0 0011 14H7z"></path>'
        };

        // Tampilkan modal login
        function showLoginModal() {
            if (isAdminMode) {
                logout();
            } else {
                document.getElementById('loginModal').classList.remove('hidden');
                document.getElementById('loginModal').classList.add('flex');
            }
        }

        // Tutup modal login
        function closeLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('loginModal').classList.remove('flex');
            document.getElementById('loginForm').reset();
            document.getElementById('loginError').classList.add('hidden');
        }

        // Login admin
        function login(username, password) {
            if (username === adminCredentials.username && password === adminCredentials.password) {
                isAdminMode = true;
                const body = document.body;
                const loginToggle = document.getElementById('loginToggle');
                
                body.classList.add('admin-mode');
                loginToggle.innerHTML = `
                    <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    Logout
                `;
                loginToggle.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                loginToggle.classList.add('bg-red-600', 'hover:bg-red-700');
                
                closeLoginModal();
                renderPrograms();
                return true;
            }
            return false;
        }

        // Logout admin
        function logout() {
            isAdminMode = false;
            isDragMode = false;
            const body = document.body;
            const loginToggle = document.getElementById('loginToggle');
            const dragToggleBtn = document.getElementById('dragToggleBtn');
            
            body.classList.remove('admin-mode', 'drag-mode');
            loginToggle.innerHTML = `
                <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M3 3a1 1 0 011 1v12a1 1 0 11-2 0V4a1 1 0 011-1zm7.707 3.293a1 1 0 010 1.414L9.414 9H17a1 1 0 110 2H9.414l1.293 1.293a1 1 0 01-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                Login
            `;
            loginToggle.classList.remove('bg-red-600', 'hover:bg-red-700');
            loginToggle.classList.add('bg-blue-600', 'hover:bg-blue-700');
            
            // Reset drag button
            dragToggleBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
            dragToggleBtn.classList.add('bg-gray-600', 'hover:bg-gray-700');
            
            renderPrograms();
        }

        // Toggle drag mode
        function toggleDragMode() {
            if (!isAdminMode) {
                alert('Login sebagai admin terlebih dahulu untuk menggunakan fitur drag & drop!');
                return;
            }
            
            isDragMode = !isDragMode;
            const body = document.body;
            const dragToggleBtn = document.getElementById('dragToggleBtn');
            
            if (isDragMode) {
                body.classList.add('drag-mode');
                dragToggleBtn.classList.remove('bg-gray-600', 'hover:bg-gray-700');
                dragToggleBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                dragToggleBtn.title = 'Nonaktifkan Drag & Drop';
                alert('Mode drag & drop aktif! Sekarang Anda bisa menggeser kotak program untuk mengubah urutan.');
            } else {
                body.classList.remove('drag-mode');
                dragToggleBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                dragToggleBtn.classList.add('bg-gray-600', 'hover:bg-gray-700');
                dragToggleBtn.title = 'Aktifkan Drag & Drop';
            }
            
            renderPrograms();
        }

        // Render program grid
        function renderPrograms() {
            const grid = document.getElementById('programGrid');
            grid.innerHTML = '';

            // Filter programs based on admin mode
            const visiblePrograms = isAdminMode ? programs : programs.filter(p => p.active !== false);

            visiblePrograms.forEach(program => {
                const programCard = document.createElement('div');
                const isInactive = program.active === false;
                
                programCard.className = `program-card bg-gradient-to-br ${colorClasses[program.color]} rounded-xl p-6 text-white cursor-pointer ${isInactive ? 'program-inactive' : ''}`;
                programCard.setAttribute('data-program-id', program.id);

                programCard.innerHTML = `
                    <div class="admin-controls">
                        <button class="status-btn ${program.active !== false ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-500 hover:bg-gray-600'} p-2 rounded-lg text-white transition-all duration-200 hover:scale-110 shadow-lg" 
                                onclick="toggleProgramStatus(${program.id})" 
                                title="${program.active !== false ? 'Program Aktif - Klik untuk Nonaktifkan' : 'Program Nonaktif - Klik untuk Aktifkan'}">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                ${program.active !== false ? 
                                    '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>' :
                                    '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>'
                                }
                            </svg>
                        </button>
                        <button class="edit-btn bg-white bg-opacity-20 hover:bg-opacity-30 p-2 rounded-lg transition-all duration-200 hover:scale-110" 
                                onclick="editProgram(${program.id})" 
                                title="Edit Program">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                            </svg>
                        </button>
                        <button class="delete-btn bg-red-500 hover:bg-red-600 p-2 rounded-lg text-white transition-all duration-200 hover:scale-110 shadow-lg" 
                                onclick="deleteProgram(${program.id})" 
                                title="Hapus Program">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"></path>
                                <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v6a1 1 0 11-2 0V6a1 1 0 011-1zM8 5a1 1 0 000 2v6a2 2 0 002 2h4a2 2 0 002-2V7a1 1 0 100-2H8z" clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                ${programIcons[program.icon] || programIcons.default}
                            </svg>
                        </div>
                        <span class="text-xs bg-white bg-opacity-20 px-2 py-1 rounded-full">
                            ${program.active !== false ? 'Aktif' : 'Nonaktif'}
                        </span>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">${program.name}</h3>
                    <p class="text-sm opacity-90">${program.description}</p>
                `;

                // Add drag and drop functionality
                if (isDragMode && isAdminMode) {
                    programCard.draggable = true;
                    
                    programCard.addEventListener('dragstart', (e) => {
                        draggedElement = programCard;
                        draggedIndex = visiblePrograms.indexOf(program);
                        programCard.classList.add('dragging');
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', programCard.outerHTML);
                    });
                    
                    programCard.addEventListener('dragend', (e) => {
                        programCard.classList.remove('dragging');
                        draggedElement = null;
                        draggedIndex = null;
                        // Remove all placeholders
                        document.querySelectorAll('.drag-placeholder').forEach(p => p.remove());
                    });
                    
                    programCard.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                        
                        if (draggedElement && draggedElement !== programCard) {
                            const rect = programCard.getBoundingClientRect();
                            const midY = rect.top + rect.height / 2;
                            const midX = rect.left + rect.width / 2;
                            
                            // Remove existing placeholders
                            document.querySelectorAll('.drag-placeholder').forEach(p => p.remove());
                            
                            // Create placeholder
                            const placeholder = document.createElement('div');
                            placeholder.className = 'drag-placeholder';
                            placeholder.innerHTML = 'Letakkan di sini';
                            
                            // Determine drop position based on mouse position
                            if (e.clientY < midY || (e.clientY === midY && e.clientX < midX)) {
                                programCard.parentNode.insertBefore(placeholder, programCard);
                            } else {
                                programCard.parentNode.insertBefore(placeholder, programCard.nextSibling);
                            }
                        }
                    });
                    
                    programCard.addEventListener('drop', (e) => {
                        e.preventDefault();
                        
                        if (draggedElement && draggedElement !== programCard) {
                            const draggedProgramId = parseInt(draggedElement.getAttribute('data-program-id'));
                            const targetProgramId = parseInt(programCard.getAttribute('data-program-id'));
                            
                            // Find programs in the main array
                            const draggedProgram = programs.find(p => p.id === draggedProgramId);
                            const targetProgram = programs.find(p => p.id === targetProgramId);
                            
                            if (draggedProgram && targetProgram) {
                                // Remove dragged program from array
                                const draggedProgramIndex = programs.indexOf(draggedProgram);
                                programs.splice(draggedProgramIndex, 1);
                                
                                // Find new position and insert
                                const targetIndex = programs.indexOf(targetProgram);
                                const rect = programCard.getBoundingClientRect();
                                const midY = rect.top + rect.height / 2;
                                const midX = rect.left + rect.width / 2;
                                
                                if (e.clientY < midY || (e.clientY === midY && e.clientX < midX)) {
                                    programs.splice(targetIndex, 0, draggedProgram);
                                } else {
                                    programs.splice(targetIndex + 1, 0, draggedProgram);
                                }
                                
                                // Re-render programs
                                renderPrograms();
                                
                                // Show success message
                                alert(`Program "${draggedProgram.name}" berhasil dipindahkan!`);
                            }
                        }
                        
                        // Remove all placeholders
                        document.querySelectorAll('.drag-placeholder').forEach(p => p.remove());
                    });
                } else {
                    // Add click event for opening program (only when not in drag mode)
                    programCard.addEventListener('click', (e) => {
                        // Don't open program if clicking on admin buttons
                        if (e.target.closest('.admin-controls')) {
                            return;
                        }
                        // Don't open program in drag mode
                        if (isDragMode) {
                            return;
                        }
                        openProgram(program);
                    });
                }

                grid.appendChild(programCard);
            });

            // Update counters
            const activeCount = programs.filter(p => p.active !== false).length;
            const totalCount = programs.length;
            
            // Update header counter - show only active programs for public, all for admin
            document.getElementById('programCount').textContent = isAdminMode ? totalCount : activeCount;
            
            // Update statistics section
            document.getElementById('totalProgramCount').textContent = totalCount;
            document.getElementById('activeProgramCount').textContent = activeCount;
        }

        // Toggle program status (active/inactive)
        function toggleProgramStatus(id) {
            // Prevent event bubbling
            event.stopPropagation();
            
            console.log('Toggle status for program ID:', id);
            
            // Pastikan hanya admin yang bisa mengubah status
            if (!isAdminMode) {
                alert('Akses ditolak! Login sebagai admin untuk mengubah status program.');
                return;
            }
            
            const program = programs.find(p => p.id === id);
            if (!program) {
                console.error('Program not found:', id);
                alert('Program tidak ditemukan!');
                return;
            }
            
            // Toggle status
            program.active = program.active !== false ? false : true;
            
            console.log(`Program "${program.name}" status changed to:`, program.active ? 'Active' : 'Inactive');
            
            // Re-render programs to update display
            renderPrograms();
            
            // Show notification
            const statusText = program.active ? 'diaktifkan' : 'dinonaktifkan';
            alert(`Program "${program.name}" berhasil ${statusText}!`);
        }

        // Enhanced delete function with confirmation
        function deleteProgram(id) {
            // Prevent event bubbling
            event.stopPropagation();
            
            console.log('Delete function called with ID:', id);
            
            // Pastikan hanya admin yang bisa menghapus
            if (!isAdminMode) {
                alert('Akses ditolak! Login sebagai admin untuk menghapus program.');
                return;
            }
            
            const program = programs.find(p => p.id === id);
            if (!program) {
                console.error('Program not found:', id);
                alert('Program tidak ditemukan!');
                return;
            }
            
            console.log('Found program to delete:', program.name);
            
            // Simple confirmation dialog
            if (confirm(`Hapus program "${program.name}"?`)) {
                console.log('User confirmed deletion');
                
                // Remove program from array
                const programName = program.name;
                
                // Filter out the program
                programs = programs.filter(p => p.id !== id);
                
                console.log('Programs after deletion:', programs.length);
                
                // Close program detail page if it's currently open
                if (currentProgramId === id) {
                    closeProgramDetail();
                }
                
                // Re-render the grid
                renderPrograms();
                
                // Show success message
                alert(`Program "${programName}" berhasil dihapus!`);
            } else {
                console.log('User cancelled deletion');
            }
        }

        // Edit program function
        function editProgram(id) {
            // Prevent event bubbling
            event.stopPropagation();
            
            console.log('Editing program:', id);
            const program = programs.find(p => p.id === id);
            if (!program) {
                console.error('Program not found for editing:', id);
                return;
            }

            editingProgramId = id;
            document.getElementById('editModalTitle').textContent = 'Edit Program';
            document.getElementById('programName').value = program.name;
            document.getElementById('programDescription').value = program.description;
            document.getElementById('programColor').value = program.color;
            document.getElementById('programLink').value = program.link || '';
            
            // Set selected icon
            const iconValue = program.icon || 'school';
            document.getElementById('programIcon').value = iconValue;
            
            // Update icon selection visual
            document.querySelectorAll('.icon-option').forEach(option => {
                option.classList.remove('selected');
            });
            const selectedOption = document.querySelector(`[data-icon="${iconValue}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
            
            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
        }

        // Buka program
        function openProgram(program) {
            currentProgramId = program.id;
            
            // Set judul program
            document.getElementById('detailProgramTitle').textContent = program.name;
            
            // Load konten yang sudah ada
            loadProgramDetail(program);
            
            // Tampilkan tombol edit hanya jika dalam mode admin
            if (isAdminMode) {
                document.getElementById('editDetailBtn').classList.remove('hidden');
            } else {
                document.getElementById('editDetailBtn').classList.add('hidden');
            }
            
            // Reset mode edit
            isEditingDetail = false;
            document.getElementById('saveDetailBtn').classList.add('hidden');
            document.getElementById('addDashboardBtn').classList.add('hidden');
            
            // Pastikan semua form edit tersembunyi di mode normal
            if (!isAdminMode) {
                document.getElementById('pengantarEdit').classList.add('hidden');
                document.getElementById('objectiveEdit').classList.add('hidden');
                document.getElementById('materiEditForm').classList.add('hidden');
                document.getElementById('dashboardEditForm').classList.add('hidden');
                
                document.getElementById('pengantarView').classList.remove('hidden');
                document.getElementById('objectiveView').classList.remove('hidden');
                document.getElementById('materiListView').classList.remove('hidden');
                document.getElementById('dashboardListView').classList.remove('hidden');
            }
            
            // Tampilkan halaman detail
            document.getElementById('programDetailPage').classList.remove('hidden');
        }

        // Load detail program
        function loadProgramDetail(program) {
            // Load tujuan
            const pengantarView = document.getElementById('pengantarView');
            const pengantarEdit = document.getElementById('pengantarEdit');
            if (program.pengantar) {
                pengantarView.innerHTML = `<p>${program.pengantar.replace(/\n/g, '<br>')}</p>`;
            } else {
                pengantarView.innerHTML = '<p class="text-gray-400 italic">Belum ada tujuan. Klik tombol Edit untuk menambahkan.</p>';
            }
            pengantarEdit.value = program.pengantar;

            // Load objective
            const objectiveView = document.getElementById('objectiveView');
            const objectiveEdit = document.getElementById('objectiveEdit');
            if (program.objective) {
                objectiveView.innerHTML = `<p>${program.objective.replace(/\n/g, '<br>')}</p>`;
            } else {
                objectiveView.innerHTML = '<p class="text-gray-400 italic">Belum ada objective. Klik tombol Edit untuk menambahkan.</p>';
            }
            objectiveEdit.value = program.objective;

            // Load materi
            loadMateriListView(program.materi);
            loadMateriEditForm(program.materi);

            // Load dashboards
            loadDashboardListView(program.dashboards);
            loadDashboardEditForm(program.dashboards);
        }

        // Load materi list view
        function loadMateriListView(materi) {
            const materiListView = document.getElementById('materiListView');
            
            if (!materi || materi.length === 0) {
                materiListView.innerHTML = '<p class="text-gray-400 italic">Belum ada materi. Klik tombol Edit untuk menambahkan.</p>';
                return;
            }

            let html = '';
            materi.forEach((materiItem, index) => {
                html += renderSingleMateri(materiItem, index);
            });
            
            materiListView.innerHTML = html;
        }

        // Render single materi item
        function renderSingleMateri(materiItem, index) {
            const title = materiItem.title || `Materi ${index + 1}`;
            
            switch(materiItem.type) {
                case 'text':
                    return `
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-gray-200 px-2 py-1 rounded-full">Teks</span>
                            </div>
                            <p class="text-gray-600">${materiItem.content ? materiItem.content.replace(/\n/g, '<br>') : 'Tidak ada konten'}</p>
                        </div>
                    `;
                    
                case 'link':
                    return `
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-orange-200 px-2 py-1 rounded-full">Link</span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
                                        <svg class="w-4 h-4 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <a href="${materiItem.url}" target="_blank" class="text-orange-600 hover:text-orange-800 font-medium">
                                            Buka Materi â†’
                                        </a>
                                    </div>
                                </div>
                                ${materiItem.youtube ? `
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center">
                                        <svg class="w-4 h-4 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v2a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <a href="${materiItem.youtube}" target="_blank" class="text-red-600 hover:text-red-800 font-medium">
                                            Tonton di YouTube â†’
                                        </a>
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    
                case 'file':
                    return `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-green-200 px-2 py-1 rounded-full">File</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <a href="${materiItem.url}" target="_blank" class="text-green-600 hover:text-green-800 font-medium">
                                        Download File â†’
                                    </a>
                                    ${materiItem.description ? `<p class="text-sm text-gray-500 mt-1">${materiItem.description}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                    
                case 'video':
                    return `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-red-200 px-2 py-1 rounded-full">Video</span>
                            </div>
                            <div class="border border-gray-200 rounded-lg overflow-hidden">
                                <iframe src="${materiItem.url}" 
                                        width="100%" 
                                        height="315" 
                                        frameborder="0" 
                                        allowfullscreen
                                        class="w-full">
                                </iframe>
                            </div>
                            ${materiItem.description ? `<p class="text-sm text-gray-600 mt-2">${materiItem.description}</p>` : ''}
                        </div>
                    `;
                    
                default:
                    return '';
            }
        }

        // Load dashboard list view
        function loadDashboardListView(dashboards) {
            const dashboardListView = document.getElementById('dashboardListView');
            
            if (!dashboards || dashboards.length === 0) {
                dashboardListView.innerHTML = '<p class="text-gray-400 italic">Belum ada dashboard. Klik tombol Edit untuk menambahkan.</p>';
                return;
            }

            let html = '';
            dashboards.forEach((dashboard, index) => {
                html += renderSingleDashboard(dashboard, index);
            });
            
            dashboardListView.innerHTML = html;
        }

        // Render single dashboard item
        function renderSingleDashboard(dashboard, index) {
            const title = dashboard.title || `Dashboard ${index + 1}`;
            
            switch(dashboard.type) {
                case 'text':
                    return `
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-gray-200 px-2 py-1 rounded-full">Teks</span>
                            </div>
                            <p class="text-gray-600">${dashboard.content ? dashboard.content.replace(/\n/g, '<br>') : 'Tidak ada konten'}</p>
                        </div>
                    `;
                    
                case 'link':
                    return `
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-blue-200 px-2 py-1 rounded-full">Link</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <a href="${dashboard.url}" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium">
                                        Buka Dashboard â†’
                                    </a>
                                </div>
                            </div>
                        </div>
                    `;
                    
                case 'iframe':
                    return `
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-purple-200 px-2 py-1 rounded-full">Iframe</span>
                            </div>
                            <div class="border border-gray-200 rounded-lg overflow-hidden">
                                <iframe src="${dashboard.url}" 
                                        width="100%" 
                                        height="${dashboard.height || 600}" 
                                        frameborder="0" 
                                        class="w-full">
                                </iframe>
                            </div>
                        </div>
                    `;
                    
                case 'html':
                    return `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">${title}</h4>
                                <span class="text-xs bg-green-200 px-2 py-1 rounded-full">HTML</span>
                            </div>
                            <div class="border border-gray-200 rounded-lg p-4 bg-white">
                                ${dashboard.content || 'Tidak ada konten HTML'}
                            </div>
                        </div>
                    `;
                    
                default:
                    return '';
            }
        }

        // Load materi edit form
        function loadMateriEditForm(materi) {
            const container = document.getElementById('materiItemsContainer');
            container.innerHTML = '';
            
            if (!materi || materi.length === 0) {
                addNewMateri();
                return;
            }
            
            materi.forEach((materiItem, index) => {
                addMateriItem(materiItem, index);
            });
        }

        // Load dashboard edit form
        function loadDashboardEditForm(dashboards) {
            const container = document.getElementById('dashboardItemsContainer');
            container.innerHTML = '';
            
            if (!dashboards || dashboards.length === 0) {
                addNewDashboard();
                return;
            }
            
            dashboards.forEach((dashboard, index) => {
                addDashboardItem(dashboard, index);
            });
        }

        // Tutup halaman detail program
        function closeProgramDetail() {
            document.getElementById('programDetailPage').classList.add('hidden');
            currentProgramId = null;
            isEditingDetail = false;
            
            // Reset tampilan edit
            document.getElementById('editDetailBtn').classList.remove('hidden');
            document.getElementById('saveDetailBtn').classList.add('hidden');
            document.getElementById('addMateriBtn').classList.add('hidden');
            document.getElementById('addDashboardBtn').classList.add('hidden');
            
            // Sembunyikan semua form edit
            document.getElementById('pengantarEdit').classList.add('hidden');
            document.getElementById('objectiveEdit').classList.add('hidden');
            document.getElementById('materiEditForm').classList.add('hidden');
            document.getElementById('dashboardEditForm').classList.add('hidden');
            
            // Tampilkan semua view
            document.getElementById('pengantarView').classList.remove('hidden');
            document.getElementById('objectiveView').classList.remove('hidden');
            document.getElementById('materiListView').classList.remove('hidden');
            document.getElementById('dashboardListView').classList.remove('hidden');
        }

        // Add new materi item to edit form
        function addNewMateri() {
            // Hanya izinkan tambah materi jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            const container = document.getElementById('materiItemsContainer');
            const index = container.children.length;
            addMateriItem({
                title: '',
                type: 'text',
                content: '',
                url: '',
                description: ''
            }, index);
        }

        // Add materi item to edit form
        function addMateriItem(materiItem, index) {
            const container = document.getElementById('materiItemsContainer');
            const materiDiv = document.createElement('div');
            materiDiv.className = 'border border-gray-200 rounded-lg p-4 bg-gray-50';
            materiDiv.setAttribute('data-index', index);
            
            materiDiv.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <h4 class="font-semibold text-gray-800">Materi ${index + 1}</h4>
                    <button type="button" onclick="removeMateriItem(${index})" class="text-red-600 hover:text-red-800 p-1">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <!-- Title Input -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Judul Materi</label>
                        <input type="text" class="materi-title w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="Masukkan judul materi..." value="${materiItem.title || ''}">
                    </div>
                    
                    <!-- Type Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipe Materi</label>
                        <select class="materi-type w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                onchange="toggleMateriInputs(${index})">
                            <option value="text" ${materiItem.type === 'text' ? 'selected' : ''}>Teks/Deskripsi</option>
                            <option value="link" ${materiItem.type === 'link' ? 'selected' : ''}>Link/Tautan</option>
                            <option value="file" ${materiItem.type === 'file' ? 'selected' : ''}>File Download</option>
                            <option value="video" ${materiItem.type === 'video' ? 'selected' : ''}>Video Embed</option>
                        </select>
                    </div>

                    <!-- Text Input -->
                    <div class="input-text ${materiItem.type !== 'text' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Konten Materi</label>
                        <textarea class="materi-content w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                  rows="4" placeholder="Masukkan konten materi...">${materiItem.content || ''}</textarea>
                    </div>

                    <!-- Link Input -->
                    <div class="input-link ${materiItem.type !== 'link' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL Materi</label>
                        <input type="url" class="materi-url w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://materi.example.com" value="${materiItem.url || ''}">
                        <p class="text-sm text-gray-500 mt-1">Link akan dibuka di tab baru</p>
                        
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-4">URL YouTube (opsional)</label>
                        <input type="url" class="materi-youtube w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://www.youtube.com/watch?v=VIDEO_ID" value="${materiItem.youtube || ''}">
                        <p class="text-sm text-gray-500 mt-1">Link video YouTube terkait materi</p>
                    </div>

                    <!-- File Input -->
                    <div class="input-file ${materiItem.type !== 'file' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL File</label>
                        <input type="url" class="materi-url w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://example.com/file.pdf" value="${materiItem.url || ''}">
                        
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-4">Deskripsi File</label>
                        <input type="text" class="materi-description w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="Contoh: Panduan Lengkap (PDF, 2MB)" value="${materiItem.description || ''}">
                    </div>

                    <!-- Video Input -->
                    <div class="input-video ${materiItem.type !== 'video' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL Video Embed</label>
                        <input type="url" class="materi-url w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://www.youtube.com/embed/VIDEO_ID" value="${materiItem.url || ''}">
                        <p class="text-sm text-gray-500 mt-1">Gunakan URL embed untuk YouTube, Vimeo, dll.</p>
                        
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-4">Deskripsi Video</label>
                        <textarea class="materi-description w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                  rows="2" placeholder="Deskripsi singkat tentang video...">${materiItem.description || ''}</textarea>
                    </div>
                </div>
            `;
            
            container.appendChild(materiDiv);
        }

        // Toggle materi input types for specific item
        function toggleMateriInputs(index) {
            const container = document.querySelector(`#materiItemsContainer [data-index="${index}"]`);
            if (!container) return;
            
            const typeSelect = container.querySelector('.materi-type');
            const type = typeSelect.value;
            
            // Hide all inputs first
            container.querySelector('.input-text').classList.add('hidden');
            container.querySelector('.input-link').classList.add('hidden');
            container.querySelector('.input-file').classList.add('hidden');
            container.querySelector('.input-video').classList.add('hidden');
            
            // Show selected input
            container.querySelector(`.input-${type}`).classList.remove('hidden');
        }

        // Remove materi item
        function removeMateriItem(index) {
            // Hanya izinkan hapus materi jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            const container = document.getElementById('materiItemsContainer');
            const item = container.querySelector(`[data-index="${index}"]`);
            if (item) {
                item.remove();
                // Re-index remaining items
                reindexMateriItems();
            }
        }

        // Re-index materi items after removal
        function reindexMateriItems() {
            const container = document.getElementById('materiItemsContainer');
            const items = container.children;
            
            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                item.setAttribute('data-index', i);
                
                // Update title
                const titleElement = item.querySelector('h4');
                titleElement.textContent = `Materi ${i + 1}`;
                
                // Update remove button onclick
                const removeBtn = item.querySelector('button[onclick*="removeMateriItem"]');
                removeBtn.setAttribute('onclick', `removeMateriItem(${i})`);
                
                // Update type select onchange
                const typeSelect = item.querySelector('.materi-type');
                typeSelect.setAttribute('onchange', `toggleMateriInputs(${i})`);
            }
        }

        // Add new dashboard item to edit form
        function addNewDashboard() {
            // Hanya izinkan tambah dashboard jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            const container = document.getElementById('dashboardItemsContainer');
            const index = container.children.length;
            addDashboardItem({
                title: '',
                type: 'text',
                content: '',
                url: '',
                height: 600
            }, index);
        }

        // Add dashboard item to edit form
        function addDashboardItem(dashboard, index) {
            const container = document.getElementById('dashboardItemsContainer');
            const dashboardDiv = document.createElement('div');
            dashboardDiv.className = 'border border-gray-200 rounded-lg p-4 bg-gray-50';
            dashboardDiv.setAttribute('data-index', index);
            
            dashboardDiv.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <h4 class="font-semibold text-gray-800">Dashboard ${index + 1}</h4>
                    <button type="button" onclick="removeDashboardItem(${index})" class="text-red-600 hover:text-red-800 p-1">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <!-- Title Input -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Judul Dashboard</label>
                        <input type="text" class="dashboard-title w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="Masukkan judul dashboard..." value="${dashboard.title || ''}">
                    </div>
                    
                    <!-- Type Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipe Dashboard</label>
                        <select class="dashboard-type w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                onchange="toggleDashboardInputs(${index})">
                            <option value="text" ${dashboard.type === 'text' ? 'selected' : ''}>Teks/Deskripsi</option>
                            <option value="link" ${dashboard.type === 'link' ? 'selected' : ''}>Link/Tautan</option>
                            <option value="iframe" ${dashboard.type === 'iframe' ? 'selected' : ''}>Embed Iframe</option>
                            <option value="html" ${dashboard.type === 'html' ? 'selected' : ''}>HTML Custom</option>
                        </select>
                    </div>

                    <!-- Text Input -->
                    <div class="input-text ${dashboard.type !== 'text' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi Dashboard</label>
                        <textarea class="dashboard-content w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                  rows="4" placeholder="Masukkan deskripsi dashboard...">${dashboard.content || ''}</textarea>
                    </div>

                    <!-- Link Input -->
                    <div class="input-link ${dashboard.type !== 'link' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL Dashboard</label>
                        <input type="url" class="dashboard-url w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://dashboard.example.com" value="${dashboard.url || ''}">
                        <p class="text-sm text-gray-500 mt-1">Link akan dibuka di tab baru</p>
                    </div>

                    <!-- Iframe Input -->
                    <div class="input-iframe ${dashboard.type !== 'iframe' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL untuk Embed</label>
                        <input type="url" class="dashboard-url w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="https://dashboard.example.com/embed" value="${dashboard.url || ''}">
                        <p class="text-sm text-gray-500 mt-1">Dashboard akan ditampilkan langsung di halaman ini</p>
                        
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-4">Tinggi Iframe (px)</label>
                        <input type="number" class="dashboard-height w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               placeholder="600" value="${dashboard.height || 600}">
                    </div>

                    <!-- HTML Input -->
                    <div class="input-html ${dashboard.type !== 'html' ? 'hidden' : ''}">
                        <label class="block text-sm font-medium text-gray-700 mb-2">HTML Custom</label>
                        <textarea class="dashboard-content w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm" 
                                  rows="6" placeholder="<div>Masukkan HTML custom untuk dashboard...</div>">${dashboard.content || ''}</textarea>
                        <p class="text-sm text-gray-500 mt-1">Hati-hati dengan kode HTML. Pastikan aman dan valid.</p>
                    </div>
                </div>
            `;
            
            container.appendChild(dashboardDiv);
        }

        // Toggle dashboard input types for specific item
        function toggleDashboardInputs(index) {
            const container = document.querySelector(`[data-index="${index}"]`);
            if (!container) return;
            
            const typeSelect = container.querySelector('.dashboard-type');
            const type = typeSelect.value;
            
            // Hide all inputs first
            container.querySelector('.input-text').classList.add('hidden');
            container.querySelector('.input-link').classList.add('hidden');
            container.querySelector('.input-iframe').classList.add('hidden');
            container.querySelector('.input-html').classList.add('hidden');
            
            // Show selected input
            container.querySelector(`.input-${type}`).classList.remove('hidden');
        }

        // Remove dashboard item
        function removeDashboardItem(index) {
            // Hanya izinkan hapus dashboard jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            const container = document.getElementById('dashboardItemsContainer');
            const item = container.querySelector(`[data-index="${index}"]`);
            if (item) {
                item.remove();
                // Re-index remaining items
                reindexDashboardItems();
            }
        }

        // Re-index dashboard items after removal
        function reindexDashboardItems() {
            const container = document.getElementById('dashboardItemsContainer');
            const items = container.children;
            
            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                item.setAttribute('data-index', i);
                
                // Update title
                const titleElement = item.querySelector('h4');
                titleElement.textContent = `Dashboard ${i + 1}`;
                
                // Update remove button onclick
                const removeBtn = item.querySelector('button[onclick*="removeDashboardItem"]');
                removeBtn.setAttribute('onclick', `removeDashboardItem(${i})`);
                
                // Update type select onchange
                const typeSelect = item.querySelector('.dashboard-type');
                typeSelect.setAttribute('onchange', `toggleDashboardInputs(${i})`);
            }
        }

        // Toggle mode edit detail
        function toggleEditMode() {
            // Hanya izinkan edit jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            isEditingDetail = !isEditingDetail;
            
            if (isEditingDetail) {
                // Masuk mode edit
                document.getElementById('editDetailBtn').classList.add('hidden');
                document.getElementById('saveDetailBtn').classList.remove('hidden');
                document.getElementById('addMateriBtn').classList.remove('hidden');
                document.getElementById('addDashboardBtn').classList.remove('hidden');
                
                // Tampilkan textarea, sembunyikan view
                document.getElementById('pengantarEdit').classList.remove('hidden');
                document.getElementById('objectiveEdit').classList.remove('hidden');
                document.getElementById('materiEditForm').classList.remove('hidden');
                document.getElementById('dashboardEditForm').classList.remove('hidden');
                
                document.getElementById('pengantarView').classList.add('hidden');
                document.getElementById('objectiveView').classList.add('hidden');
                document.getElementById('materiListView').classList.add('hidden');
                document.getElementById('dashboardListView').classList.add('hidden');
            } else {
                // Keluar mode edit
                document.getElementById('editDetailBtn').classList.remove('hidden');
                document.getElementById('saveDetailBtn').classList.add('hidden');
                document.getElementById('addMateriBtn').classList.add('hidden');
                document.getElementById('addDashboardBtn').classList.add('hidden');
                
                // Sembunyikan form, tampilkan view
                document.getElementById('pengantarEdit').classList.add('hidden');
                document.getElementById('objectiveEdit').classList.add('hidden');
                document.getElementById('materiEditForm').classList.add('hidden');
                document.getElementById('dashboardEditForm').classList.add('hidden');
                
                document.getElementById('pengantarView').classList.remove('hidden');
                document.getElementById('objectiveView').classList.remove('hidden');
                document.getElementById('materiListView').classList.remove('hidden');
                document.getElementById('dashboardListView').classList.remove('hidden');
            }
        }

        // Simpan perubahan detail
        function saveDetailChanges() {
            // Hanya izinkan simpan jika dalam mode admin
            if (!isAdminMode) {
                return;
            }
            
            const program = programs.find(p => p.id === currentProgramId);
            if (!program) return;
            
            // Simpan data tujuan dan objective
            program.pengantar = document.getElementById('pengantarEdit').value;
            program.objective = document.getElementById('objectiveEdit').value;
            
            // Simpan data materi
            const materiContainer = document.getElementById('materiItemsContainer');
            const materiItems = materiContainer.children;
            program.materi = [];
            
            for (let i = 0; i < materiItems.length; i++) {
                const item = materiItems[i];
                const title = item.querySelector('.materi-title').value;
                const type = item.querySelector('.materi-type').value;
                
                const materiItem = {
                    title: title,
                    type: type,
                    content: '',
                    url: '',
                    description: ''
                };
                
                switch(type) {
                    case 'text':
                        materiItem.content = item.querySelector('.materi-content').value;
                        break;
                    case 'link':
                        materiItem.url = item.querySelector('.materi-url').value;
                        materiItem.youtube = item.querySelector('.materi-youtube').value;
                        break;
                    case 'file':
                        materiItem.url = item.querySelector('.materi-url').value;
                        materiItem.description = item.querySelector('.materi-description').value;
                        break;
                    case 'video':
                        materiItem.url = item.querySelector('.materi-url').value;
                        materiItem.description = item.querySelector('.materi-description').value;
                        break;
                }
                
                program.materi.push(materiItem);
            }
            
            // Simpan data dashboards
            const container = document.getElementById('dashboardItemsContainer');
            const dashboardItems = container.children;
            program.dashboards = [];
            
            for (let i = 0; i < dashboardItems.length; i++) {
                const item = dashboardItems[i];
                const title = item.querySelector('.dashboard-title').value;
                const type = item.querySelector('.dashboard-type').value;
                
                const dashboard = {
                    title: title,
                    type: type,
                    content: '',
                    url: '',
                    height: 600
                };
                
                switch(type) {
                    case 'text':
                    case 'html':
                        dashboard.content = item.querySelector('.dashboard-content').value;
                        break;
                    case 'link':
                        dashboard.url = item.querySelector('.dashboard-url').value;
                        break;
                    case 'iframe':
                        dashboard.url = item.querySelector('.dashboard-url').value;
                        dashboard.height = parseInt(item.querySelector('.dashboard-height').value) || 600;
                        break;
                }
                
                program.dashboards.push(dashboard);
            }
            
            // Load ulang tampilan
            loadProgramDetail(program);
            
            // Keluar dari mode edit
            toggleEditMode();
            
            alert('Perubahan berhasil disimpan!');
        }

        // Buka modal tambah program
        function openAddProgramModal() {
            editingProgramId = null;
            document.getElementById('editModalTitle').textContent = 'Tambah Program Baru';
            document.getElementById('programForm').reset();
            
            // Reset icon selection to default (school)
            document.getElementById('programIcon').value = 'school';
            document.querySelectorAll('.icon-option').forEach(option => {
                option.classList.remove('selected');
            });
            const defaultOption = document.querySelector('[data-icon="school"]');
            if (defaultOption) {
                defaultOption.classList.add('selected');
            }
            
            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
        }

        // Tutup modal edit
        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg text-white transform transition-all duration-300 translate-x-full`;
            
            switch(type) {
                case 'success':
                    notification.classList.add('bg-green-500');
                    break;
                case 'error':
                    notification.classList.add('bg-red-500');
                    break;
                case 'warning':
                    notification.classList.add('bg-yellow-500');
                    break;
                default:
                    notification.classList.add('bg-blue-500');
            }
            
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Toggle backup menu
        function toggleBackupMenu() {
            const menu = document.getElementById('backupMenu');
            menu.classList.toggle('hidden');
        }

        // Close backup menu
        function closeBackupMenu() {
            const menu = document.getElementById('backupMenu');
            menu.classList.add('hidden');
        }

        // Close backup menu when clicking outside
        document.addEventListener('click', function(e) {
            const backupBtn = document.getElementById('backupBtn');
            const backupMenu = document.getElementById('backupMenu');
            
            if (backupBtn && backupMenu && !backupBtn.contains(e.target) && !backupMenu.contains(e.target)) {
                closeBackupMenu();
            }
        });

        // Download backup function
        function downloadBackup() {
            try {
                // Get current HTML content
                const htmlContent = document.documentElement.outerHTML;
                
                // Create backup object with current data
                const backupData = {
                    timestamp: new Date().toISOString(),
                    version: '1.0',
                    programs: programs,
                    isAdminMode: isAdminMode,
                    htmlContent: htmlContent
                };
                
                // Create downloadable file
                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                // Create download link
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(dataBlob);
                
                // Generate filename with timestamp
                const now = new Date();
                const timestamp = now.toISOString().slice(0, 19).replace(/[:.]/g, '-');
                downloadLink.download = `dashboard-backup-${timestamp}.json`;
                
                // Trigger download
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // Clean up object URL
                URL.revokeObjectURL(downloadLink.href);
                
                // Show success notification
                showNotification('Backup berhasil diunduh!', 'success');
                
            } catch (error) {
                console.error('Error creating backup:', error);
                showNotification('Gagal membuat backup. Silakan coba lagi.', 'error');
            }
        }

        // Download HTML file function
        function downloadHTMLBackup() {
            try {
                // Get current HTML content
                const htmlContent = document.documentElement.outerHTML;
                
                // Create HTML blob
                const htmlBlob = new Blob([htmlContent], {type: 'text/html'});
                
                // Create download link
                const downloadLink = document.createElement('a');
                downloadLink.href = URL.createObjectURL(htmlBlob);
                
                // Generate filename with timestamp
                const now = new Date();
                const timestamp = now.toISOString().slice(0, 19).replace(/[:.]/g, '-');
                downloadLink.download = `dashboard-${timestamp}.html`;
                
                // Trigger download
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // Clean up object URL
                URL.revokeObjectURL(downloadLink.href);
                
                // Show success notification
                showNotification('File HTML berhasil diunduh!', 'success');
                
            } catch (error) {
                console.error('Error downloading HTML:', error);
                showNotification('Gagal mengunduh file HTML. Silakan coba lagi.', 'error');
            }
        }

        // Handle login form submit
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (login(username, password)) {
                document.getElementById('loginError').classList.add('hidden');
            } else {
                document.getElementById('loginError').classList.remove('hidden');
            }
        });

        // Handle program form submit
        document.getElementById('programForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('programName').value;
            const description = document.getElementById('programDescription').value;
            const color = document.getElementById('programColor').value;
            const icon = document.getElementById('programIcon').value;
            const link = document.getElementById('programLink').value;

            if (editingProgramId) {
                // Edit existing program
                const program = programs.find(p => p.id === editingProgramId);
                if (program) {
                    program.name = name;
                    program.description = description;
                    program.color = color;
                    program.icon = icon;
                    program.link = link;
                }
            } else {
                // Add new program
                const newId = Math.max(...programs.map(p => p.id)) + 1;
                programs.push({
                    id: newId,
                    name: name,
                    description: description,
                    color: color,
                    icon: icon,
                    link: link,
                    pengantar: '',
                    objective: '',
                    materi: [],
                    dashboards: [],
                    active: true
                });
            }

            renderPrograms();
            closeEditModal();
        });

        // Close modals when clicking outside
        document.getElementById('loginModal').addEventListener('click', function(e) {
            if (e.target === this) closeLoginModal();
        });

        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) closeEditModal();
        });

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            renderPrograms();
        });

        // Also initialize immediately
        renderPrograms();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98382a512479ce5b',t:'MTc1ODYxMDgyOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
